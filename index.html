<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- Mobile-friendly viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Flower Field with Book-Flip Letter Card</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Inline override to ensure flower containers are fixed -->
  <style>
    .flower-container {
      position: fixed;
      -webkit-transform: translate(0, 0);
      transform: translate(0, 0);
    }
  </style>
</head>
<body>
  <!-- Flower Field -->
  <div id="flower-field">
    <!-- Flower Container 1: Stem Curving Left (Not flipped) -->
    <div class="flower-container" style="transform: translate(50px, 100px) scale(1);">
      <svg class="flower-svg" viewBox="0 0 200 550" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="glow">
            <feGaussianBlur stdDeviation="3" result="coloredBlur" />
            <feMerge>
              <feMergeNode in="coloredBlur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>
        <path id="stem-path" d="M200,550 Q 100,400 80,300 Q 60,200 80,180"
              stroke="#27ae60" stroke-width="4" fill="none" stroke-linecap="round"
              filter="url(#glow)" -webkit-filter="url(#glow)" />
        <g id="flower" transform="translate(70,100)" filter="url(#glow)" -webkit-filter="url(#glow)">
          <g id="petals">
            <g class="petal" data-rotate="0" transform="rotate(0) scale(0)">
              <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                    fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
            </g>
            <g class="petal" data-rotate="72" transform="rotate(72) scale(0)">
              <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                    fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
            </g>
            <g class="petal" data-rotate="144" transform="rotate(144) scale(0)">
              <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                    fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
            </g>
            <g class="petal" data-rotate="216" transform="rotate(216) scale(0)">
              <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                    fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
            </g>
            <g class="petal" data-rotate="288" transform="rotate(288) scale(0)">
              <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                    fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
            </g>
          </g>
          <circle id="flower-core" cx="0" cy="0" r="8" fill="#c0392b" transform="scale(0)" />
        </g>
      </svg>
    </div>

    <!-- Flower Container 2: Stem Curving Left but Flipped Horizontally -->
    <div class="flower-container" style="transform: translate(200px, 150px) scale(1);">
      <div class="flip-horizontal">
        <svg class="flower-svg" viewBox="0 0 200 550" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="coloredBlur" />
              <feMerge>
                <feMergeNode in="coloredBlur" />
                <feMergeNode in="SourceGraphic" />
              </feMerge>
            </filter>
          </defs>
          <path id="stem-path" d="M200,550 Q 100,400 80,300 Q 60,200 70,100"
                stroke="#27ae60" stroke-width="4" fill="none" stroke-linecap="round"
                filter="url(#glow)" -webkit-filter="url(#glow)" />
          <g id="flower" transform="translate(70,100)" filter="url(#glow)" -webkit-filter="url(#glow)">
            <g id="petals">
              <g class="petal" data-rotate="0" transform="rotate(0) scale(0)">
                <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                      fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
              </g>
              <g class="petal" data-rotate="72" transform="rotate(72) scale(0)">
                <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                      fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
              </g>
              <g class="petal" data-rotate="144" transform="rotate(144) scale(0)">
                <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                      fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
              </g>
              <g class="petal" data-rotate="216" transform="rotate(216) scale(0)">
                <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                      fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
              </g>
              <g class="petal" data-rotate="288" transform="rotate(288) scale(0)">
                <path d="M0,0 C -20,-20 -20,-50 0,-50 C 20,-50 20,-20 0,0 Z"
                      fill="#C9A9A6" stroke="#AA336A" stroke-width="2" />
              </g>
            </g>
            <circle id="flower-core" cx="0" cy="0" r="8" fill="#c0392b" transform="scale(0)" />
          </g>
        </svg>
      </div>
    </div>
    <!-- (Add more flower containers as needed) -->
  </div>

  <!-- Book-Style Letter Card -->
  <!-- The container (#letter-card) starts at 300px wide so only one page is visible. -->
  <div id="letter-card">
    <svg id="letter-svg" width="600" height="400" viewBox="0 0 600 400" xmlns="http://www.w3.org/2000/svg">
      <style>
        /* Left page settings */
        #leftPage {
          transform-origin: 100% 50%;
          -webkit-transform-origin: 100% 50%;
          transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          -webkit-transition: -webkit-transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          transform-style: preserve-3d;
          -webkit-transform-style: preserve-3d;
          /* Closed state: front face visible, no flip */
          transform: rotateY(0deg);
          -webkit-transform: rotateY(0deg);
        }
        
        .page-face {
          backface-visibility: hidden;
          -webkit-backface-visibility: hidden;
        }
        
        /* Pre-rotate the back face so itâ€™s hidden when not flipped */
        #leftPage .back {
          transform: rotateY(180deg);
          -webkit-transform: rotateY(180deg);
        }
        
        /* Right page settings */
        #rightPage {
          opacity: 0;
          transition: opacity 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
          -webkit-transition: opacity 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        /* When the container has the .open class: flip the left page to show its back face and reveal the right page */
        #letter-card.open #leftPage {
          transform: rotateY(180deg);
          -webkit-transform: rotateY(180deg);
        }
        
        #letter-card.open #rightPage {
          opacity: 1;
        }
        
        /* Mobile override inside the SVG to ensure consistency */
        @media screen and (max-width: 600px) {
          /* Force closed state on mobile */
          #leftPage {
            transform: rotateY(0deg) !important;
            -webkit-transform: rotateY(0deg) !important;
          }
          /* Ensure the back face remains hidden */
          #leftPage .back {
            transform: rotateY(180deg) !important;
            -webkit-transform: rotateY(180deg) !important;
          }
          #rightPage {
            opacity: 0 !important;
          }
        }
      </style>
      <rect x="0" y="0" width="600" height="400" fill="#f8f8f8"/>
      <line x1="300" y1="0" x2="300" y2="400" stroke="#ccc" stroke-width="2"/>
      <g id="rightPage">
        <rect x="300" y="0" width="300" height="400" fill="#fff" stroke="#ddd" stroke-width="2"/>
        <text x="450" y="200" font-size="24" text-anchor="middle" fill="#333" dominant-baseline="middle">
          RELEASE THE BUTTERFLIES
        </text>
      </g>
      <g id="leftPage">
        <g class="page-face front">
          <rect x="0" y="0" width="300" height="400" fill="#fff" stroke="#ddd" stroke-width="2"/>
          <text x="150" y="200" font-size="24" text-anchor="middle" fill="#333" dominant-baseline="middle">
            Click me
          </text>
        </g>
        <g class="page-face back">
          <rect x="0" y="0" width="300" height="400" fill="#f0f0f0" stroke="#ddd" stroke-width="2"/>
          <text x="150" y="200" font-size="24" text-anchor="middle" fill="#333" dominant-baseline="middle">
            Left Page
          </text>
        </g>
      </g>
    </svg>
  </div>

  <!-- Butterfly Elements -->
  <div id="butterfly-container"></div>

  <!-- JavaScript Files -->
  <script src="./script/letter.js"></script>
  <script type="module" src="./script/script.js"></script>
</body>
</html>
